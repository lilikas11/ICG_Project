import{b as m,f as i,aa as F}from"./three.module-DNuG-gUZ.js";const g=new m,c=new F,l=new m;class X{constructor(y,M){this.object=y,this.domElement=M,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.001,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=10,this.heightMax=10,this.constrainVertical=!1,this.verticalMin=.1,this.verticalMax=Math.PI/2-.1,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.pointerX=0,this.pointerY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;let t=0,a=0,f;this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onPointerDown=function(e){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(e.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0;break}this.mouseDragOn=!0},this.onPointerUp=function(e){if(this.activeLook)switch(e.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1;break}this.mouseDragOn=!1},this.onPointerMove=function(e){this.domElement===document?(this.pointerX=e.pageX-this.viewHalfX,this.pointerY=e.pageY-this.viewHalfY):(this.pointerX=e.pageX-this.domElement.offsetLeft-this.viewHalfX,this.pointerY=e.pageY-this.domElement.offsetTop-this.viewHalfY),clearTimeout(f),f=setTimeout(()=>{this.pointerX=0,this.pointerY=0},500)},this.onKeyDown=function(e){switch(e.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0;break}},this.onKeyUp=function(e){switch(e.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1;break}},this.lookAt=function(e,o,s){return e.isVector3?l.copy(e):l.set(e,o,s),this.object.lookAt(l),b(this),this},this.update=function(){const e=new m;return function(s){if(this.enabled===!1)return;let n=s*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(n+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(n),this.moveLeft&&this.object.translateX(-n),this.moveRight&&this.object.translateX(n),this.object.position.y=this.heightMin;let r=s*this.lookSpeed;this.activeLook||(r=0);let E=1;this.constrainVertical&&(E=Math.PI/(this.verticalMax-this.verticalMin)),a-=this.pointerX*r,this.lookVertical&&(t-=this.pointerY*r*E),t=Math.max(-85,Math.min(85,t));let h=i.degToRad(90-t);const D=i.degToRad(a);this.constrainVertical&&(h=i.mapLinear(h,0,Math.PI,this.verticalMin,this.verticalMax));const K=this.object.position;e.setFromSphericalCoords(1,h,D).add(K),this.object.lookAt(e)}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",L),this.domElement.removeEventListener("pointerdown",w),this.domElement.removeEventListener("pointermove",v),this.domElement.removeEventListener("pointerup",p),window.removeEventListener("keydown",u),window.removeEventListener("keyup",k)};const v=this.onPointerMove.bind(this),w=this.onPointerDown.bind(this),p=this.onPointerUp.bind(this),u=this.onKeyDown.bind(this),k=this.onKeyUp.bind(this);this.domElement.addEventListener("contextmenu",L),this.domElement.addEventListener("pointerdown",w),this.domElement.addEventListener("pointermove",v),this.domElement.addEventListener("pointerup",p),window.addEventListener("keydown",u),window.addEventListener("keyup",k);function b(e){const o=e.object.quaternion;g.set(0,0,-1).applyQuaternion(o),c.setFromVector3(g),t=90-i.radToDeg(c.phi),a=i.radToDeg(c.theta)}this.handleResize(),b(this)}}function L(d){d.preventDefault()}export{X as F};
